# CRM システム要件定義書

## 1. プロジェクト概要

### 1.1 プロジェクト名
**Showcase CRM** - B2B顧客管理・商談パイプラインシステム

### 1.2 目的
- 法人顧客の情報を一元管理し、商談プロセスを可視化
- AIによる顧客スコアリングで営業活動を効率化
- チーム全体での顧客情報共有を実現

### 1.3 対象ユーザー
- 小規模〜中規模チーム（2-10人）の営業担当者
- 営業マネージャー

---

## 2. 機能要件

### 2.1 認証・認可（優先度: 高）
- [ ] メール/パスワード認証
- [ ] OAuth認証（Google）
- [ ] ロールベースアクセス制御（RBAC）
  - 管理者: 全機能アクセス
  - マネージャー: チーム全体の閲覧・編集
  - メンバー: 自分の担当顧客のみ

### 2.2 顧客管理（優先度: 高）
- [ ] 企業情報CRUD（会社名、業種、従業員数、URL等）
- [ ] 担当者情報CRUD（氏名、役職、連絡先）
- [ ] 顧客ステータス管理（見込み、アクティブ、休眠、解約）
- [ ] タグ・ラベル機能
- [ ] 検索・フィルター機能
- [ ] CSVインポート/エクスポート

### 2.3 商談管理・パイプライン（優先度: 高）
- [ ] パイプラインステージ: リード → 商談 → 提案 → 受注/失注
- [ ] 商談CRUD（案件名、金額、確度、予定日）
- [ ] ドラッグ&ドロップでステージ変更
- [ ] 商談履歴・タイムライン表示

### 2.4 活動履歴（優先度: 中）
- [ ] 活動記録（電話、メール、訪問、Web会議）
- [ ] 次回アクション予定設定
- [ ] リマインダー通知

### 2.5 ダッシュボード・KPI（優先度: 高）
- [ ] 売上予測グラフ
- [ ] 商談ステージ別件数
- [ ] 成約率・コンバージョン率
- [ ] 担当者別パフォーマンス
- [ ] 期間比較（前月比、前年比）

### 2.6 AI機能（優先度: 高）
- [ ] 顧客スコアリング（成約確度の自動予測）
- [ ] 次のアクション提案
- [ ] 顧客セグメント自動分類

### 2.7 チーム・権限管理（優先度: 中）
- [ ] チーム作成・メンバー招待
- [ ] 担当者割り当て
- [ ] アクティビティログ

---

## 3. 非機能要件

### 3.1 パフォーマンス
- ページ読み込み: 3秒以内
- API応答: 500ms以内
- 同時接続: 100ユーザー

### 3.2 セキュリティ
- HTTPS必須
- JWTトークン認証
- CSRF対策
- 入力バリデーション
- SQLインジェクション対策（Prisma ORM使用）

### 3.3 可用性
- SLA: 99.5%
- 自動バックアップ（Supabase提供）

### 3.4 保守性
- TypeScript: 型安全性
- ESLint/Prettier: コード品質
- テストカバレッジ: 80%以上
- API仕様: OpenAPI 3.0

---

## 4. 技術スタック

### 4.1 フロントエンド
| 技術 | バージョン | 用途 |
|------|-----------|------|
| Next.js | 15.x | App Router, Server Actions |
| TypeScript | 5.x | 型安全性 |
| TailwindCSS | 3.x | スタイリング |
| shadcn/ui | latest | UIコンポーネント |
| React Query | 5.x | データフェッチング |
| Zustand | 4.x | 状態管理 |
| React Hook Form | 7.x | フォーム管理 |
| Zod | 3.x | バリデーション |

### 4.2 バックエンド
| 技術 | 用途 |
|------|------|
| Next.js API Routes | APIエンドポイント |
| Prisma | ORM |
| Supabase | PostgreSQL + 認証 |

### 4.3 AI・外部API
| サービス | 用途 | 無料枠 |
|---------|------|--------|
| Gemini API | 顧客スコアリング | 60 req/分 |
| Resend | メール通知 | 3000通/月 |

### 4.4 インフラ・DevOps
| サービス | 用途 |
|---------|------|
| Vercel | ホスティング |
| GitHub Actions | CI/CD |
| Supabase | DB + Auth |

---

## 5. Claude Code機能活用計画

### 5.1 MCP (Model Context Protocol)
```json
{
  "mcpServers": {
    "supabase": {
      "command": "npx",
      "args": ["@supabase/mcp-server"]
    },
    "filesystem": {
      "command": "npx",
      "args": ["@anthropic/mcp-server-filesystem", "./"]
    }
  }
}
```

### 5.2 スキル（カスタムコマンド）
| コマンド | 機能 |
|---------|------|
| `/deploy` | Vercelへデプロイ |
| `/test` | テスト実行 |
| `/migrate` | DBマイグレーション |
| `/seed` | テストデータ投入 |
| `/analyze` | コード品質分析 |

### 5.3 フック
```json
{
  "hooks": {
    "PreCommit": ["npm run lint", "npm run type-check"],
    "PostCommit": ["npm run test"]
  }
}
```

### 5.4 サブエージェント活用
- **Explore**: コードベース探索（軽量タスク）
- **Plan**: アーキテクチャ設計（複雑なタスク）
- **Bash (Haiku)**: 並列タスク実行

---

## 6. 画面一覧

| 画面名 | パス | 説明 |
|--------|------|------|
| ログイン | `/login` | 認証画面 |
| ダッシュボード | `/dashboard` | KPI・概要 |
| 顧客一覧 | `/customers` | 顧客リスト |
| 顧客詳細 | `/customers/[id]` | 顧客情報・履歴 |
| 商談一覧 | `/deals` | パイプライン表示 |
| 商談詳細 | `/deals/[id]` | 商談情報 |
| 活動履歴 | `/activities` | 活動ログ |
| 設定 | `/settings` | チーム・権限設定 |

---

## 7. データモデル（ER図概要）

```
Organization (組織)
├── User (ユーザー)
├── Customer (顧客)
│   ├── Contact (担当者)
│   ├── Deal (商談)
│   │   └── Activity (活動)
│   └── CustomerScore (AIスコア)
└── Team (チーム)
```

---

## 8. 開発フェーズ（転職評価優先）

### Phase 1: 基盤構築（評価: ★★★）
- プロジェクトセットアップ
- 認証・認可システム
- 基本的なCRUD API
- CI/CD パイプライン

### Phase 2: コア機能（評価: ★★★）
- 顧客管理機能
- 商談パイプライン
- ダッシュボード

### Phase 3: AI統合（評価: ★★★）
- Gemini API連携
- 顧客スコアリング
- 次アクション提案

### Phase 4: 品質向上（評価: ★★★）
- テスト実装（Unit/Integration/E2E）
- パフォーマンス最適化
- ドキュメント整備

### Phase 5: 拡張機能（評価: ★★）
- メール通知
- CSVインポート/エクスポート
- 詳細な権限管理

---

## 9. 成果物

- [ ] ソースコード（GitHub）
- [ ] デプロイ済みアプリケーション（Vercel）
- [ ] API仕様書（OpenAPI）
- [ ] テストレポート
- [ ] README（セットアップ手順）
